1. SELECT R2 WHERE ( NOT phone = 135121 OR username = "andrew" ) AND NOT username = "jim" -> T1
DIFFERENCE R1 AND T1 -> T2
DIVIDE R3 BY T2 OVER username -> T3
JOIN T2 AND T3 OVER username -> T4
TIMES R3 AND T4 -> T5
JOIN T5 AND T4 OVER group username phone

2. SELECT R1 WHERE name = "andrew" AND NOT phone = "754743" -> T1
DIFFERENCE R2 AND T1 -> T2
DIVIDE R3 BY T2 OVER name -> T3
JOIN T2 AND T3 OVER name -> T4
TIMES R3 AND T4 -> T5
JOIN T5 AND T4 OVER name phone -> T6
PROJECT T5 OVER name phone -> T7
UNION T2 AND T4 -> T8
INTERSECT T7 AND T8 -> T9
DIFFERENCE T2 AND T9

SELECT R1 WHERE name = "andrew" AND NOT phone = "754743" -> T1
DIFFERENCE R2 AND T1 -> T2
DIVIDE R3 BY T2 OVER name -> T3
JOIN T2 AND T3 OVER name -> T4
TIMES R3 AND T4 -> T5
JOIN T5 AND T4 OVER name phone -> T6
PROJECT T5 OVER name phone
